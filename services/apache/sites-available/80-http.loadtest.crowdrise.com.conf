# VirtualHost example:
# Almost any Apache directive may go into a VirtualHost container.
# The first VirtualHost section is used for requests without a known
# server name.
#

#THIS VHOST IS USING THE 2015-www.crowdrise.com.crt EV SSL CERTIFICATE

<VirtualHost *:80>
    ServerAdmin admin@crowdrise.com
    DocumentRoot /var/www/vhosts/www.crowdrise.com/htdocs/content/
    ServerName www.crowdrise.com
    ServerAlias loadtest.crowdrise.com crowdrise.com
    #DirectoryIndex index.php
    <Directory /var/www/vhosts/www.crowdrise.com/htdocs/content>
        Options Indexes FollowSymLinks
        Order allow,deny
        Allow from all 
        # AllowOverride all

	RewriteEngine On
        RewriteBase /

#	RewriteRule ^.*cdn\/static\/(.*)$ /library/images/$1 [L]
     #RewriteRule ^cdn/static/(.*) https://d5c60638deb65a060cd1-a6fb21974edc38859f382ce646dd74d6.ssl.cf1.rackcdn.com/$1 [L]

        ## Updated CDN hosted rewrites - 04/29/14
        RewriteRule ^cdn\/static\/(.*)$ https://c0814182.ssl.cf0.rackcdn.com/$1 [L]
        RewriteRule ^cdn\/sponsors\/(.*)$ https://8b06e46ebf87e3f0daf6-e79f3080c1124b03cadb0ae843a3feab.ssl.cf1.rackcdn.com/$1 [L]
        RewriteRule ^cdn\/promos\/(.*)$ https://6fb396b632bdbc1bd03f-f581598f2f311b95632d3e7494a9ef3d.ssl.cf1.rackcdn.com/$1 [L]
        RewriteRule ^cdn\/prizes\/(.*)$ https://519137cdab1efc297ece-6e94e7698a26abecd3321bcd707036d5.ssl.cf1.rackcdn.com/$1 [L]
        RewriteRule ^cdn\/featured\/(.*)$ https://549ffe16bf42da5dfa37-d282f066325cc64e8f932e4861b14966.ssl.cf1.rackcdn.com/$1 [L]
        RewriteRule ^cdn\/board\/(.*)$ https://a47c14658fa200fa52e5-9ae5ba899302e6cc5513ee6bd236c1e1.ssl.cf1.rackcdn.com/$1 [L]
        RewriteRule ^cdn\/apparel\/(.*)$ https://6be7ebca2ff534f24fe1-71fb85c5bf6e61481d7d624b41e2503c.ssl.cf1.rackcdn.com/$1 [L]
        RewriteRule ^cdn\/contests\/(.*)$ https://2c972fdea3ed264bcc5b-fb8b2d7e3319a95d13302e690e5aef1a.ssl.cf1.rackcdn.com/$1 [L]
        RewriteRule ^cdn\/custom\/(.*)$ https://96d13626a21fc74ed99b-abd11c2dea1bf4ad0351000675930b85.ssl.cf1.rackcdn.com/$1 [L]
        
        ## Added for sitewide https compatibility - 04/29/14
        RewriteRule ^media/crlogos/(.*) https://080c438d178bf7907c06-2a295e660b2fbfdd0c7b7d378a0e8cdf.ssl.cf1.rackcdn.com/$1 [L]
        RewriteRule ^media/cdnemail/(.*) https://b7e876b10a4b94db55df-3439004d0b0c9711822a2ba2c500bfc6.ssl.cf1.rackcdn.com/$1 [L]
        RewriteRule ^media/cdncustom/(.*) https://96d13626a21fc74ed99b-abd11c2dea1bf4ad0351000675930b85.ssl.cf1.rackcdn.com/$1 [L]
        RewriteRule ^media/egreetings/(.*) https://73ae88ba8c770fe56aa7-e36d6db4400cea8560b233da2b219f02.ssl.cf1.rackcdn.com/$1 [L]
        ## end sitewide https additions ##

	RewriteRule ^media/small/(.*) https://c676152.ssl.cf0.rackcdn.com/$1 [L]
	RewriteRule ^media/medium/(.*) https://c676142.ssl.cf0.rackcdn.com/$1 [L]
	RewriteRule ^media/large/(.*) https://c676132.ssl.cf0.rackcdn.com/$1 [L]
	RewriteRule ^media/logos/(.*) https://c681462.ssl.cf0.rackcdn.com/$1 [L]
	RewriteRule ^media/static/(.*) https://c0814182.ssl.cf0.rackcdn.com/$1 [L]
	RewriteRule ^media/background/(.*) https://7eb67815dbb144324220-ed99ac55e16439b1728fbf3d4c455727.ssl.cf1.rackcdn.com/$1 [L]
	RewriteRule ^media/original/(.*) https://9c404004ce0d907890fa-fbe50a01167c9238a8e63220e2af5ab8.ssl.cf1.rackcdn.com/$1 [L]
	RewriteRule ^media/featured/(.*) https://f2b69735cebf9fc9980e-d282f066325cc64e8f932e4861b14966.ssl.cf1.rackcdn.com/$1 [L]

	RewriteRule ^devmedia/static/(.*) https://5e2b5dc349a7281c0a7c-003c63d117f8e639c4a06bda677c954d.ssl.cf1.rackcdn.com/$1 [L]
	RewriteRule ^devmedia/small/(.*) https://c5c201052da55a3a5863-94bdb048d55baef3a419063646a33628.ssl.cf1.rackcdn.com/$1 [L]
	RewriteRule ^devmedia/medium/(.*) https://52ea41969d1bd768fc9f-115ec6b70114898c587c96bbb0bd6e61.ssl.cf1.rackcdn.com/$1 [L]
	RewriteRule ^devmedia/large/(.*) https://0e4428a24fcb59373d2c-fa625075a119091f478a40be7ed5effa.ssl.cf1.rackcdn.com/$1 [L]
	RewriteRule ^devmedia/logos/(.*) https://707b09e0c02afd3edcca-8b42cd7d19314cd27af5671b2d1120b4.ssl.cf1.rackcdn.com/$1 [L]
	RewriteRule ^devmedia/background/(.*) https://ddaa6edfef7f7126aac5-d1dd89307f1eb9360630436e422fe8ac.ssl.cf1.rackcdn.com/$1 [L]
	RewriteRule ^devmedia/original/(.*) https://6ab4bb81a7c47fecfb2c-4963084e7e27faa04308d5c353f4a981.ssl.cf1.rackcdn.com/$1 [L]
	RewriteRule ^devmedia/featured/(.*) https://962fe09b00c39b17153d-ac899d6e5ef81ab8d90b58bcdedbd9aa.ssl.cf1.rackcdn.com/$1 [L]

        RewriteCond %{REQUEST_FILENAME} -d
        RewriteRule ^(.*)$ /index_loadtest.php [L]

        #Ignore version numbers in file names for busting cache
        RewriteRule (.*)-ver\d+\.(.*)$ $1.$2 [L]

        #Checks to see if the user is attempting to access a valid file,
        #such as an image or css document, if this isn't true it sends the
        #request to index.php
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^(.*)$ index_loadtest.php?/$1 [L]

        RewriteCond %{HTTP:Accept-Encoding} gzip
        RewriteCond %{REQUEST_FILENAME}.jgz -f
        RewriteRule (.*)\.js$ $1\.js.jgz [L]
        AddType "text/javascript" .js.jgz
        AddEncoding gzip .jgz

    </Directory>

    
   # SSLEngine on
#	SSLProtocol All -SSLv2 -SSLv3
#	SSLCipherSuite HIGH:MEDIUM:!aNULL:!MD5:!SSLv3:!SSLv2:!TLSv1



# NEW 2015 www.crowdrise.com EV SSL CERTIFICATE
#
#SSLCertificateFile      /etc/pki/tls/certs/2015-www.crowdrise.com.crt
#SSLCertificateKeyFile   /etc/pki/tls/private/2015-www.crowdrise.com.key
#SSLCertificateChainFile /etc/pki/tls/certs/2015-www.crowdrise.com.crt.ca
#

# NEW 2016 wildcard.crowdrise.com SSL CERTIFICATE
#
#SSLCertificateFile      /etc/pki/tls/certs/2016-wildcard.crowdrise.com.crt
#SSLCertificateKeyFile   /etc/pki/tls/private/2016-wildcard.crowdrise.com.key
#SSLCertificateChainFile /etc/pki/tls/certs/2016-wildcard.crowdrise.com.crt.ca
#

# ORIGINAL wildcard.crowdrise.com SSL CERTIFICATE

#    SSLCertificateFile /etc/httpd/ssl.d/crowdrise.com.cert
#   SSLCertificateKeyFile /etc/httpd/ssl.d/crowdrise.com.key
#    SSLCertificateChainFile /etc/httpd/conf/ssl.crt/intermediate.crt

    ErrorLog /var/www/vhosts/www.crowdrise.com/logs/http-www.crowdrise.com-error_log
    CustomLog /var/www/vhosts/www.crowdrise.com/logs/http-www.crowdrise.com-access_log common
</VirtualHost>
